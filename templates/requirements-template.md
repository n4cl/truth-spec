# 要件定義テンプレート（1サービス1ドキュメント用）  
`docs/requirements.md` にコピーし、不要セクションは削除・統合する前提で使う。各セクションでは「外から観測できる振る舞い・品質」を書き、手段や実装は設計側へ。ガイド行は書き終わったら削除してよい。

## 1. プロダクト概要
- **目的**: なぜやるか。誰のどの課題を解くか（1–2 文）。
- **ゴール**: 何をもって成功とみなすか（計測できる完了条件）。
- **スコープ（含む / 含まない）**: 含める機能・領域と明確に外すものを箇条書きで。
- **ステークホルダー**: 関与するロールを列挙（責務は設計/運用計画側で可）。
- **用語 / ドメイン定義**: 誤読しやすい用語だけ短く定義。残りは設計ドキュメントで補足可。

## 2. ユースケース / シナリオ（優先度順）
> サービス全体の主要フローをカバー。1シナリオは単独で価値を出す粒度にし、3–7 本程度に抑える。

### シナリオ1 – [タイトル] (P1)
- **ユーザーストーリー**: 「誰が」**[利用者/役割]** が、「何をしたい」**[目的]**、その結果「なぜ嬉しい」**[得たい価値]**。
- **受け入れシナリオ (Given / When / Then)**:  
  1. 前提（Given）…、操作（When）…、結果（Then）…  
  2. …
- **優先理由 / 評価指標（完了判定の目安）**: 例）完了率、P95 レイテンシ、エラー率

### シナリオ2 – [タイトル] (P2)
- ユーザーストーリー / 受け入れシナリオ / 評価指標

### エッジケース
- 境界条件やエラー時にどう振る舞うかを短く。冗長なら設計側に詳細を書く。

## 3. 機能要件（FR）
> 「1 要件 = 1 観測可能な振る舞い」。UI/実装詳細は書かず、外部から確認できる結果を記す。5〜15 件に収める。

- **FR-001** (Scenario 1): システムは …
- **FR-002** (Scenario 1,2): …
- **FR-003**: …

## 4. 非機能要件（NFR）
- **性能**: 例）P95 レイテンシ ≤ … / 想定 QPS …（手段は設計で決定）
- **信頼性・可用性**: SLO/SLA、エラーバジェット、復旧目標
- **セキュリティ / プライバシー**: 認証・認可、データ保護、監査（具体的なプロトコル/実装は設計側で選択）
- **ユーザビリティ / アクセシビリティ**: A11y 目標、対応プラットフォーム
- **運用性 / 可観測性**: ログ、メトリクス、トレース、アラート
> NFR は数値や達成状態をできる限り書く。未確定ならレンジやTBDでも良いが、決定タスクを別途起こす。

## 5. データとインターフェース
- **主要エンティティ / ドメインモデル**: どんな情報を扱うか、その役割と不変条件を一言で。詳細スキーマは設計側へ。
- **API / インターフェース**: どの相手にどんな契約が必要かを列挙（例: 読み取りAPI、更新API）。プロトコル・I/O 詳細・エラーモデルは設計フェーズで決定し、スキーマ詳細は system-detail 側へ。
- **イベント / メッセージ**: どんなイベントを発行/購読する必要があるか（例: 注文作成を外部通知、在庫更新を購読）。スキーマや保証は設計側で詰める。
> ここでは「何が必要か」だけを書く。どう実現するかは設計へ。

## 6. 制約と前提
- ビジネス制約: 料金、ポリシー、契約など
- 技術制約: 依存サービス、ランタイム、データ所在 など（ここで技術を固定する場合は理由も書く）
- 前提 / 依存関係: 前提が崩れたら要件再検討

## 7. 成功基準
- **SC-001**: 計測可能な成果（技術依存でない指標）
- **SC-002**: …
> ゴールを測る指標をここに一覧化。KPI/SLI 抜き出し場所として使う。

## 8. 未確定事項 / リスク
- Q1: …
- リスク: 影響度 / 確率 / 対応（オーナー）
> 未確定は「質問」として書き出し、リスクは簡潔に（発生時対応・担当を明記）。

## 9. 参考資料（任意）
- 調査・ベンチマーク・ベンダー資料へのリンク。本文が冗長になる場合のみここに退避。

---
運用メモ
- 原則「1サービス1ドキュメント」。肥大化した場合のみ `docs/requirements/` 配下にサブファイルを分割し、`requirements.md` を親インデックスとしてリンクとスコープを明記する。分割は機能単位ではなく性質・断面（例: API 詳細、特定ドメインの大口機能）で行う。
- 長文化しそうなら図表（mermaid 等）で圧縮し、詳細スキーマは設計書（system-detail）に寄せる。
- 1000 行級に近づく前に要約・分割を検討（requirements は「何を・なぜ」に集中）。***
